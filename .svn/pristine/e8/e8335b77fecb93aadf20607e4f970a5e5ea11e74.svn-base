------------------Estructura Inicial------------------------------------------------------

CREATE DATABASE gespro CHARACTER SET utf8 COLLATE utf8_general_ci;

------------------------------------------------------------------------
CREATE TABLE ubicacion (
  ID_UBICACION int(10) NOT NULL PRIMARY KEY AUTO_INCREMENT,
  CALLE varchar(100) ,
  NUM_INT varchar(30) ,
  NUM_EXT varchar(30) ,
  COLONIA varchar(100) ,
  CODIGO_POSTAL varchar(10) ,
  PAIS varchar(100) ,
  ESTADO varchar(100) ,
  MUNICIPIO varchar(100) 
);
------------------------------------------------------------------------
CREATE TABLE tipo_empresa (
  ID_TIPO_EMPRESA INT(10) NOT NULL PRIMARY KEY AUTO_INCREMENT,
  NOMBRE VARCHAR(50) NOT NULL,
  DESCRIPCION VARCHAR(100)  
);

INSERT INTO tipo_empresa (ID_TIPO_EMPRESA, NOMBRE, DESCRIPCION) VALUES('1','FRANQUICIATARIO','FACTURE EN SEGUNDOS');
INSERT INTO tipo_empresa (ID_TIPO_EMPRESA, NOMBRE, DESCRIPCION) VALUES('2','FRANQUICIA','FANQUICIA');
INSERT INTO tipo_empresa (ID_TIPO_EMPRESA, NOMBRE, DESCRIPCION) VALUES('3','MATRIZ','MATRIZ DE UNA EMPMPRESA');
INSERT INTO tipo_empresa (ID_TIPO_EMPRESA, NOMBRE, DESCRIPCION) VALUES('4','SUCURSAL','SUCURSAL DE UNA EMPMPRESA');
------------------------------------------------------------------------
CREATE TABLE estatus (
  ID_ESTATUS INT(10) NOT NULL PRIMARY KEY,
  NOMBRE VARCHAR(100) ,
  DESCRIPCION VARCHAR(500)   
);

INSERT INTO estatus (ID_ESTATUS, NOMBRE, DESCRIPCION) VALUES('1','ACTIVO','EL ELEMENTO ESTA DISPONIBLE');
INSERT INTO estatus (ID_ESTATUS, NOMBRE, DESCRIPCION) VALUES('2','INACTIVO','EL ELEMENTO NO ESTA DISPONIBLE');

------------------------------------------------------------------------
CREATE TABLE empresa (
  ID_EMPRESA INT(10) NOT NULL PRIMARY KEY AUTO_INCREMENT,
  ID_EMPRESA_PADRE INT(10) ,
  ID_UBICACION_FISCAL INT(10) NOT NULL,
  ID_TIPO_EMPRESA INT(10) NOT NULL,
  ID_ESTATUS INT(11) NOT NULL DEFAULT '1',  
  RFC VARCHAR(14),
  RAZON_SOCIAL VARCHAR(100) ,
  NOMBRE_COMERCIAL VARCHAR(100) ,
  REGIMEN_FISCAL VARCHAR(100) ,  
  COMPARTIR_CONCEPTOS_MATRIZ INT(1) DEFAULT '0',
  LATITUD DOUBLE DEFAULT '0',
  LONGITUD DOUBLE DEFAULT '0',   
  FECHA_REGISTRO DATE , 
  GIRO VARCHAR(100) DEFAULT '' COMMENT 'GIRO DE LA EMPRESA, A QUE SE DEDICA' ,
  FOREIGN KEY (ID_EMPRESA_PADRE) REFERENCES empresa (ID_EMPRESA),
  FOREIGN KEY (ID_UBICACION_FISCAL) REFERENCES ubicacion (ID_UBICACION),
  FOREIGN KEY (ID_TIPO_EMPRESA) REFERENCES tipo_empresa (ID_TIPO_EMPRESA),
  FOREIGN KEY (ID_ESTATUS) REFERENCES estatus (ID_ESTATUS)
);


------------------------------------------------------------------------

CREATE TABLE roles(
  ID_ROLES INT(10) NOT NULL PRIMARY KEY,
  NOMBRE VARCHAR(100),
  DESCRIPCION VARCHAR(500) ,
  ID_ESTATUS INT(5) NOT NULL DEFAULT '1',  
  ID_EMPRESA INT(11) NOT NULL,
  FOREIGN KEY (ID_ESTATUS) REFERENCES estatus (ID_ESTATUS)
);

INSERT INTO roles (ID_ROLES, NOMBRE, DESCRIPCION, ID_ESTATUS, ID_EMPRESA) VALUES(1,'DESARROLLADOR','USUARIO PARA DESARROLLO','1','0');
INSERT INTO roles (ID_ROLES, NOMBRE, DESCRIPCION, ID_ESTATUS, ID_EMPRESA) VALUES(2,'ADMINISTRADOR','CLIENTE DE PAGA','1','0');
INSERT INTO roles (ID_ROLES, NOMBRE, DESCRIPCION, ID_ESTATUS, ID_EMPRESA) VALUES(3,'DIRECTOR SUCURSAL','SOLO PUEDE VER LO DE SU SUCURSAL','1','0');
INSERT INTO roles (ID_ROLES, NOMBRE, DESCRIPCION, ID_ESTATUS, ID_EMPRESA) VALUES(4,'GESPRO','USUARIO FINAL MOVIL - DEMOEDECAN','1','0');

------------------------------------------------------------------------

CREATE TABLE dispositivo_movil (
  ID_DISPOSITIVO INT(10) NOT NULL PRIMARY KEY AUTO_INCREMENT,
  ID_EMPRESA INT(10) NOT NULL,
  ID_ESTATUS INT(1) NOT NULL,
  IMEI VARCHAR(15) DEFAULT NULL,
  MARCA VARCHAR(100) DEFAULT NULL,
  MODELO VARCHAR(100) DEFAULT NULL,
  NUMERO_SERIE VARCHAR(100) DEFAULT NULL,  
  ALIAS_TELEFONO VARCHAR(150) DEFAULT '' COMMENT 'ATRIBUTO PARA COLOCAR EL ALIAS DEL CELULAR',
  REPORTE_ROBO INT(1) DEFAULT '0',
  FOREIGN KEY (ID_EMPRESA) REFERENCES empresa (ID_EMPRESA)
);

------------------------------------------------------------------------


CREATE TABLE datos_usuario (
  ID_DATOS_USUARIO int(10) NOT NULL PRIMARY KEY AUTO_INCREMENT,
  NOMBRE varchar(50) ,
  APELLIDO_PAT varchar(50) ,
  APELLIDO_MAT varchar(50) ,
  DIRECCION varchar(100) ,
  TELEFONO varchar(100) ,
  EXTENSION varchar(10) ,
  CELULAR varchar(20) ,
  CORREO varchar(100),
  NUM_EMPLEADO VARCHAR(50)
);


------------------------------------------------------------------------

CREATE TABLE ldap (
  ID_LDAP INT(10) NOT NULL PRIMARY KEY AUTO_INCREMENT,
  USUARIO VARCHAR(100) ,
  PASSWORD VARCHAR(100) ,
  CONTRASENAS VARCHAR(100)   
);

------------------------------------------------------------------------

CREATE TABLE usuarios (
  ID_USUARIOS INT(10) NOT NULL PRIMARY KEY AUTO_INCREMENT,
  ID_EMPRESA INT(10) NOT NULL,
  ID_DATOS_USUARIO INT(10) NOT NULL,
  ID_ESTATUS INT(10) NOT NULL,
  ID_ROLES INT(10) NOT NULL,
  ID_LDAP INT(10) NOT NULL,
  USER_NAME VARCHAR(100),
  FECHA_ALTA DATE ,
  FECHA_VIGENCIA DATE ,
  FECHA_ULTIMO_ACCESO TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  INTENTOS INT(2) DEFAULT '0',
  CONTRATO INT(2) DEFAULT '0',
  FECHA_CONTRATO DATE ,
  LOGIN TINYINT(1) DEFAULT '0', 
  LATITUD DOUBLE DEFAULT '0',
  LONGITUD DOUBLE DEFAULT '0',  
  ULTIMA_UBICACION DATETIME,
  ID_DISPOSITIVO INT(10),
  CLIENTES_CODIGO_BARRAS INT(1) DEFAULT '2' COMMENT 'PODRA BUSCAR A SUS CLIENTES, POR MEDIO DEL CODIGO DE BARRAS, 1 SI, 2 NO',  
  PERMISO_VENTA_CREDITO INT(11) DEFAULT '2' COMMENT 'CANDADO DE VENTA A CREDITO, PARA PERMITIR O NO HACER UNA VENTA A CREDITO POR DEFAULT ESTA DESACTIVADO EL PERMISO, 1 SI, 2 NO',
  TRABAJAR_FUERA_LINEA INT(1) DEFAULT '2' COMMENT 'EN EL MOVIL DEL EMPLEADO, EN ADMINISTRACION SE HABILITARA OPCION DE TRABAJAR FUERA DE LINEA, LA CUAL PERMITA AL EMPLEADO ELEGIR SI QUERE TRABAJAR SINCRONIZANDO EN LINEA SUS DATOS O NO, 1 SI, 2 NO',
  DISTANCIA_OBLIGATORIO DOUBLE DEFAULT '0' COMMENT 'DISTANCIA MINIMA, EN METROS, A LA QUE DEBERA DE ESTAR EL VENDEDOR PARA REGISTRAR UN MOVIMIENTO O VENTA A UN CLIENTE',
  PRECIO_DE_COMPRA INT(1) DEFAULT '2' COMMENT 'EN LOS REPORTES DE LOS VENDEDORES (DEL CELULAR) LES APARECERA ESTE PRECIO, 1 SI, 2 NO',
  PERMISO_ACCIONES_CLIENTE INT(11) DEFAULT '3',
  FOREIGN KEY (ID_EMPRESA) REFERENCES empresa (ID_EMPRESA),
  FOREIGN KEY (ID_ROLES) REFERENCES roles (ID_ROLES),
  FOREIGN KEY (ID_DATOS_USUARIO) REFERENCES datos_usuario (ID_DATOS_USUARIO),
  FOREIGN KEY (ID_ESTATUS) REFERENCES estatus (ID_ESTATUS),
  FOREIGN KEY (ID_LDAP) REFERENCES ldap (ID_LDAP)
);

------------------------------------------------------------------------

CREATE TABLE imagen_personal (
  ID_IMAGEN_PERSONAL INT(10) NOT NULL PRIMARY KEY AUTO_INCREMENT,
  ID_EMPRESA INT(10) NOT NULL,
  NOMBRE_IMAGEN VARCHAR(200) ,
  UTILIZAR TINYINT(1) DEFAULT '0',
  FOREIGN KEY (ID_EMPRESA) REFERENCES empresa (ID_EMPRESA)
);

------------------------------------------------------------------------

CREATE TABLE empresa_permiso_aplicacion (
  ID_EMPRESA INT(11) NOT NULL PRIMARY KEY,
  ACCESO_GESPRO TINYINT(4) NOT NULL  DEFAULT '0' COMMENT 'Flag para indicar si la empresa, sucursales y usuarios tienen acceso al sistema GESPRO 0 sin Acceso al sistema, 1 Consola, 2 Moviles, 3 Consola y Moviles', 
  NUM_LICENCIAS INT(5) DEFAULT '0' COMMENT 'NUMERO DE LICENCIAS QUE PODRA TENER EL USUARIOS, LOS MOVILES DEBERAN ESTAR ACTIVOS', 
  ID_LICENCIA INT(11) DEFAULT '1' COMMENT 'ID DE TIPO LICENCIA DE LA EMPRESA MATRIZ DE ACUERDO A ESQUEMAS DE VENTAS '  
);

INSERT INTO empresa_permiso_aplicacion VALUES(1,3,100,1);


------------------------------------------------------------------------

CREATE TABLE cliente_categoria (
  ID_CATEGORIA INT(11) NOT NULL PRIMARY KEY AUTO_INCREMENT,
  ID_EMPRESA INT(11) NOT NULL,
  ID_ESTATUS INT(1) DEFAULT '1' COMMENT '1 ACTIVO, 2 ELIMINADO/CANCELADO',
  NOMBRE_CLASIFICACION VARCHAR(50),
  DESCRIPCION VARCHAR(250),
  FOREIGN KEY (ID_EMPRESA) REFERENCES empresa (ID_EMPRESA)
);

------------------------------------------------------------------------

CREATE TABLE cliente (
  ID_CLIENTE INT(10) NOT NULL  PRIMARY KEY AUTO_INCREMENT,
  ID_EMPRESA INT(10) NOT NULL,
  ID_CATEGORIA INT(10) NOT NULL,
  ID_ESTATUS INT(10) ,
  NOMBRE_COMERCIAL VARCHAR(500) DEFAULT '' COMMENT 'CAMPO PARA GUARDAR EL NOMBRE COMERCIAL DEL CLIENTE',  
  CONTACTO VARCHAR(100) ,
  TELEFONO VARCHAR(20) ,
  CALLE VARCHAR(100) ,
  NUMERO VARCHAR(30) ,
  NUMERO_INTERIOR VARCHAR(30) ,
  COLONIA VARCHAR(100) ,
  CODIGO_POSTAL VARCHAR(10) ,
  PAIS VARCHAR(100) ,
  ESTADO VARCHAR(100) ,
  MUNICIPIO VARCHAR(100) , 
  CORREO VARCHAR(100) ,    
  LATITUD VARCHAR(200) ,
  LONGITUD VARCHAR(200) ,   
  FECHA_REGISTRO DATETIME  COMMENT 'FECHA DE REGISTRO DEL CLIENTE',
  ID_USUARIO_ALTA INT(11)  COMMENT 'ID USUARIO QUE REGISTRO AL CLIENTE -> USO EN MMETAS DE VENTA', 
  FOREIGN KEY (ID_EMPRESA) REFERENCES empresa (ID_EMPRESA), 
  FOREIGN KEY (ID_CATEGORIA) REFERENCES cliente_categoria (ID_CATEGORIA), 
  FOREIGN KEY (ID_ESTATUS) REFERENCES estatus (ID_ESTATUS)
);


------------------------------------------------------------------------

CREATE TABLE relacion_cliente_vendedor (
  ID_CLIENTE INT(11) NOT NULL PRIMARY KEY COMMENT 'ID del cliente',
  ID_USUARIO INT(11) NOT NULL COMMENT 'ID del usuario al que pertenece el cliente',
  FOREIGN KEY (ID_USUARIO) REFERENCES usuarios (ID_USUARIOS)
);

------------------------------------------------------------------------

CREATE TABLE movil_mensaje (
  ID_MOVIL_MENSAJE INT(11) NOT NULL  PRIMARY KEY AUTO_INCREMENT,
  EMISOR_TIPO INT(1) NOT NULL COMMENT '1 - Empleado, 2- Consola (empresa)',
  ID_USUARIO_EMISOR INT(11)  COMMENT 'Solo en caso de que el tipo emisor sea 1, null en caso contrario',
  RECEPTOR_TIPO INT(1) NOT NULL COMMENT '1- Empleado, 2- Consola (empresa)',
  ID_USUARIO_RECEPTOR INT(11)  COMMENT 'Solo en caso de que el tipo de receptor sea 1, en caso contrario null',
  FECHA_EMISION DATETIME NOT NULL COMMENT 'Fecha y hora en la que se emite el mensaje',
  FECHA_RECEPCION DATETIME  COMMENT 'Fecha y hora en la que se entrega al receptor el mensaje',
  MENSAJE VARCHAR(160) NOT NULL COMMENT 'Mensaje a emitir',
  RECIBIDO INT(1) NOT NULL DEFAULT '0' COMMENT '0- No entregado, 1- Recibido'
);

------------------------------------------------------------------------

CREATE TABLE empleado_bitacora_posicion (
  ID_BITACORA_POSICION BIGINT(20) NOT NULL  PRIMARY KEY AUTO_INCREMENT,
  ID_USUARIO INT(11) NOT NULL,
  LATITUD DOUBLE NOT NULL DEFAULT '0',
  LONGITUD DOUBLE NOT NULL DEFAULT '0',
  FECHA DATETIME NOT NULL
);

------------------------------------------------------------------------
CREATE TABLE accion_bitacora_tipo (
  id_tipo INT(11) NOT NULL PRIMARY KEY AUTO_INCREMENT,
  nombre_bitacora_accion_tipo VARCHAR(30) 
);


INSERT INTO accion_bitacora_tipo (id_tipo, nombre_bitacora_accion_tipo) VALUES('1','Login');
INSERT INTO accion_bitacora_tipo (id_tipo, nombre_bitacora_accion_tipo) VALUES('2','Logout');
INSERT INTO accion_bitacora_tipo (id_tipo, nombre_bitacora_accion_tipo) VALUES('3','Navegacion');
INSERT INTO accion_bitacora_tipo (id_tipo, nombre_bitacora_accion_tipo) VALUES('4','Descarga');

------------------------------------------------------------------------


CREATE TABLE topic (
  id_topic BIGINT(20) NOT NULL PRIMARY KEY AUTO_INCREMENT,
  title_topic VARCHAR(100) NOT NULL,
  description_topic TEXT,
  order_topic VARCHAR(5) ,
  url_topic VARCHAR(200) NOT NULL,
  is_public_topic TINYINT(4) DEFAULT '0',
  id_parent_topic BIGINT(20) ,
  is_active_topic TINYINT(4) DEFAULT '1'
);
------------------------------------------------------------------------

CREATE TABLE accion_bitacora (
  id_bitacora_accion BIGINT(20) NOT NULL PRIMARY KEY AUTO_INCREMENT,
  fecha_hora_bitacora_accion DATETIME ,
  id_user INT NOT NULL,
  comentarios_bitacora_accion TEXT,
  id_tipo_bitacora_accion_tipo INT(11) NOT NULL,
  id_topic_navegacion BIGINT(20) DEFAULT '0', 
  FOREIGN KEY (id_user) REFERENCES usuarios (ID_USUARIOS),
  FOREIGN KEY (id_tipo_bitacora_accion_tipo) REFERENCES accion_bitacora_tipo (id_tipo)  
);

------------------------------------------------------------------------
-- Configuración Inical
INSERT INTO ubicacion VALUES (1,'GIRASOLES','23','4BIS','NIÑOS HEORES','20000','MÉXICO','DISTRITO FEDERAL','CUAHUTEMOC');
INSERT INTO empresa VALUES (1,1,1,1,1,NULL,'MOVILPYME','MOVILPYME','PERSONA MORAL',1,19.417869,-99.135046,'2015-10-15','SOFTWARE');
INSERT INTO datos_usuario VALUES (1,'MOVILPYME','MOVIL','PYME','MANZANAS 54 SAN JOSE DF','1234567890','123','5512345678','hsolares@movilpyme.com');
INSERT INTO ldap VALUES(1,'MOVILPYME','ArNP5o8Gj91kFxSGB0W+Eg==',''); -- PASS: MOVILPYME
INSERT INTO usuarios VALUES(1,1,1,1,1,1,'MOVILPYME','2015-10-15','2100-10-15','2015-10-15 12:00:00',0,0,'2015-10-15',0,0,0,'2015-10-15 12:00:00',0,0,0,0,0,0,0,'001');


------------------------------------------------------------------------
ALTER TABLE usuarios
ADD COLUMN NUM_EMPLEADO VARCHAR(30)  COMMENT 'IDENTIFICADOR INTERNO DE EMPLEADO';

INSERT INTO dispositivo_movil VALUES(1,1,1,'861284020787865','ZTE','ZTE','ZTE','ZTE',0);
INSERT INTO datos_usuario VALUES (2,'GESPRO','MOVIL','GESPRO','MANZANAS 54 SAN JOSE DF','1234567890','123','5512345678','hsolares@movilpyme.com');
INSERT INTO ldap VALUES(1,'GESPRO','6GpWUNdAg26lkRVDQK6uUw==',''); -- PASS: GESPRO
INSERT INTO usuarios VALUES(2,1,2,1,4,2,'GESPRO','2015-10-15','2100-10-15','2015-10-15 12:00:00',0,0,'2015-10-15',0,0,0,'2015-10-15 12:00:00',1,0,0,0,0,0,0,'A001');

---------------------------------------------------------------------------------------------
-- Leonardo, 26-10-2015
-- Tablas para el control de los conceptos, sus propiedades y la competencia.

CREATE TABLE concepto
(
   ID_CONCEPTO INT(11) PRIMARY KEY NOT NULL AUTO_INCREMENT,
   ID_EMPRESA INT(11) NOT NULL,
   NOMBRE varchar(100),
   DESCRIPCION text,
   PRECIO decimal(20,4),
   ID_ESTATUS int,
   IDENTIFICACION varchar(50),
   id_categoria int DEFAULT 0,
   ID_MARCA int,
   ID_SUBCATEGORIA int,
   ID_EMBALAJE int,
   ID_IMPUESTO int,
   PRECIO_COMPRA decimal(20,5) DEFAULT 0.00000,
   NUMERO_LOTE varchar(30),
   FECHA_CADUCIDAD date,
   NUM_ARTICULOS_DISPONIBLES double,
   GENERICO int DEFAULT 0,
   IMAGEN_CARPETA_ARCHIVO text,
   IMAGEN_NOMBRE_ARCHIVO text,
   DESCRIPCION_CORTA varchar(50) DEFAULT 'Sin descripcion',
   ID_ALMACEN int,
   STOCK_MINIMO double DEFAULT 1,
   STOCK_AVISO_MIN bit DEFAULT 0,
   DETALLE longtext,
   FECHA_ALTA timestamp,
   VOLUMEN double DEFAULT 0,
   PESO double DEFAULT 0,
   OBSERVACIONES longtext,
   PRECIO_DOCENA double DEFAULT 0,
   PRECIO_MAYOREO double DEFAULT 0,
   PRECIO_ESPECIAL double DEFAULT 0,
   IMPUESTO_X_CONCEPTO int DEFAULT 0,
   CLAVEART_SAE varchar(20),
   DESCUENTO_PORCENTAJE double DEFAULT 0,
   DESCUENTO_MONTO double DEFAULT 0,
   PRECIO_MEDIO_MAYOREO double DEFAULT 0,
   MAX_MENUDEO double DEFAULT 0,
   MIN_MEDIO_MAYOREO double DEFAULT 0,
   MAX_MEDIO_MAYOREO double DEFAULT 0,
   MIN_MAYOREO double DEFAULT 0,
   ID_SUBCATEGORIA2 int,
   ID_SUBCATEGORIA3 int,
   ID_SUBCATEGORIA4 int,
   PRECIO_MINIMO_VENTA double DEFAULT 0,
   NOMBRE_DESENCRIPTADO text,
   RUTA_IMAGEN longtext,
   RUTA_VIDEO longtext,
   CARACTERISTISCAS longtext,
   COMISION_PORCENTAJE double DEFAULT 0,
   COMISION_MONTO double DEFAULT 0,
   SINCRONIZACION_MICROSIP int DEFAULT 0,
   CLAVE varchar(50),
   DESGLOSE_PIEZAS double DEFAULT 1,
   FOLIO_CONCEPTO_MOVIL varchar(50),
   PRECIO_UNITARIO_GRANEL double DEFAULT 0,
   PRECIO_MEDIO_GRANEL double DEFAULT 0,
   PRECIO_MAYOREO_GRANEL double DEFAULT 0,
   PRECIO_ESPECIAL_GRANEL double DEFAULT 0
);

CREATE TABLE embalaje
(
   ID_EMBALAJE int PRIMARY KEY NOT NULL AUTO_INCREMENT,
   ID_EMPRESA int NOT NULL,
   ID_ESTATUS int NOT NULL,
   NOMBRE varchar(30),
   DESCRIPCION varchar(100)
);

CREATE TABLE RELACION_CONCEPTO_EMBALAJE(
    ID_RELACION INT(11) PRIMARY KEY NOT NULL AUTO_INCREMENT,
    ID_CONCEPTO INT(11),
    ID_EMBALAJE INT(11),
    CANTIDAD DOUBLE
);

CREATE TABLE marca
(
   ID_MARCA int PRIMARY KEY NOT NULL AUTO_INCREMENT,
   ID_EMPRESA int NOT NULL,
   ID_ESTATUS int NOT NULL,
   NOMBRE varchar(30),
   DESCRIPCION varchar(100)
);

CREATE TABLE categoria
(
   id_categoria int PRIMARY KEY NOT NULL AUTO_INCREMENT,
   nombre_categoria varchar(100) NOT NULL,
   descripcion_categoria varchar(250) DEFAULT 'Sin Descripcion',
   id_categoria_padre int,
   id_empresa int NOT NULL,
   ID_ESTATUS int DEFAULT 1 NOT NULL
);

CREATE TABLE COMPETENCIA(
    ID_COMPETENCIA INT(11) PRIMARY KEY NOT NULL AUTO_INCREMENT,
    ID_EMPRESA INT(11) NOT NULL,
    ID_ESTATUS INT(11),
    NOMBRE VARCHAR(150),
    DESCRIPCION VARCHAR(500)    
);

CREATE TABLE RELACION_CONCEPTO_COMPETENCIA(
    ID_RELACION INT(11) PRIMARY KEY NOT NULL AUTO_INCREMENT,
    ID_CONCEPTO INT(11),
    ID_COMPETENCIA INT(11),
    NOMBRE_CONCEPTO_COMPETENCIA VARCHAR(100),
    DESCRIPCION VARCHAR(350),
    CANTIDAD DOUBLE,
    PRECIO decimal(20,4),
    PRECIO_COMPRA decimal(20,5) DEFAULT 0.00000,
    PRECIO_DOCENA double DEFAULT 0,
    PRECIO_MAYOREO double DEFAULT 0,
    PRECIO_ESPECIAL double DEFAULT 0,
    PRECIO_MINIMO_VENTA double DEFAULT 0,
    PRECIO_MEDIO_MAYOREO double DEFAULT 0,
    MAX_MENUDEO double DEFAULT 0,
    MIN_MEDIO_MAYOREO double DEFAULT 0,
    MAX_MEDIO_MAYOREO double DEFAULT 0,
    MIN_MAYOREO double DEFAULT 0,
    DESCUENTO_PORCENTAJE double DEFAULT 0,
    DESCUENTO_MONTO double DEFAULT 0
);

CREATE TABLE existencia_almacen
(
   ID_ALMACEN int NOT NULL AUTO_INCREMENT,
   ID_CONCEPTO int NOT NULL,
   EXISTENCIA double DEFAULT 0,
   ESTATUS int,
   PRIMARY KEY (ID_ALMACEN,ID_CONCEPTO)
);

-- Restablecimiento de password si ya se logueo o no.
alter table ldap
add column FIRMADO int default 1;

--Rutas
CREATE TABLE tipo_ruta (
	ID_TIPO_RUTA DOUBLE PRIMARY key not null AUTO_INCREMENT,
	TIPO_RUTA VARCHAR (135)
); 
INSERT INTO tipo_ruta (ID_TIPO_RUTA, TIPO_RUTA) VALUES('1','Ruta Libre');
INSERT INTO tipo_ruta (ID_TIPO_RUTA, TIPO_RUTA) VALUES('2','Ruta por clientes');
INSERT INTO tipo_ruta (ID_TIPO_RUTA, TIPO_RUTA) VALUES('3','Ruta por prospectos');
INSERT INTO tipo_ruta (ID_TIPO_RUTA, TIPO_RUTA) VALUES('4','Ruta por clientes asignados');
INSERT INTO tipo_ruta (ID_TIPO_RUTA, TIPO_RUTA) VALUES('5','Ruta por Cobranza');



CREATE TABLE ruta (
	ID_RUTA DOUBLE PRIMARY key not null AUTO_INCREMENT ,
	ID_TIPO_RUTA DOUBLE ,
	ID_USUARIO DOUBLE ,
	NOMBRE_RUTA VARCHAR (300),
	COMENTARIO_RUTA BLOB ,
	FH_REG_RUTA DATETIME ,
	RECORRIDO_RUTA BLOB ,
	PARADAS_RUTA DOUBLE ,
	ID_EMPRESA DOUBLE 
); 

create table ruta_marcador (
	ID_RUTA_MARCADOR double PRIMARY key not null AUTO_INCREMENT,
	ID_RUTA double ,
	INFORMACION_MARCADOR blob ,
	LATITUD_MARCADOR varchar (60),
	LONGITUD_MARCADOR varchar (60),
	ID_PROSPECTO double ,
	ID_CLIENTE double ,
	IS_VISITADO tinyint (4)
); 